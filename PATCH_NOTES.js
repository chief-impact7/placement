/*
---------
[2026 02 14]

선택 학생 구글 시트 내보내기 기능 추가
- 학생 목록에서 체크박스로 선택한 학생들의 데이터를 구글 드라이브에 새로운 구글 시트 파일로 저장할 수 있는 기능이 추가되었습니다.
- '명 시트로 내보내기' 버튼을 클릭하면 새 시트가 생성되고 바로 이동할 수 있는 링크가 제공됩니다.
- 인적사항과 더불어 해당 학생들의 모든 성적 데이터가 포함됩니다.

 ---------
*/
/*
---------
[2026 02 12]

성적표(ReportCard) 기능 복구
- 성적표 미리보기 버튼 클릭 시 리포트 모달이 정상적으로 나타나도록 수정되었습니다.

UI 레이아웃 정리
- 학생 목록 및 트렌드 차트의 중복 렌더링 문제를 해결하고 전체적인 태그 구조를 정리했습니다.

 ---------
*/
/*
 ---------
 [2026-02-14] (v16)

 1. **학생 목록 검색 로직 혁신 (UI/UX 개선)**
    - 부분 일치 검색 기능 강화: 이름이나 학교명의 일부만 입력해도 즉시 필터링되도록 개선했습니다.
    - 공백 무시 검색 (Normalized Search) 도입: 검색어와 데이터 양쪽의 공백을 제거하고 비교하여, '김 철 수'를 '김철수'로 검색해도 정확히 찾아냅니다.
    - 타입 안전성 및 예외 처리: 숫자로 된 데이터(학년 등) 처리 시 발생하던 잠재적 오류를 방지하기 위해 데이터 정규화 로직을 보강했습니다.

 2. **사용자 인터페이스(UI) 최적화**
    - 학생 목록 중복 표시 현상 수정: 특정 조건에서 목록이 화면 하단에 이중으로 렌더링되던 버그를 해결하여 깔끔한 화면을 제공합니다.

 ---------
 */
/*
 ---------
 [2026-02-13] (v15)

 1. **프리미엄 성적 분석표 (Report Card) 도입**
    - A4 규격에 최적화된 고품질 인쇄용 성적표 기능을 새롭게 구현했습니다.
    - `App.jsx` 내 하드코딩된 로직을 제거하고 독립적인 컴포넌트(`ReportCard.jsx`)로 분리하여 유지보수성을 극대화했습니다.
    - 초등부(🍎)/중등부(Official) 테마 시스템을 적용하여 학년에 맞는 UI를 제공합니다.

 2. **AI 종합 분석 및 심화 지표 시각화**
    - 구글 시트의 `AI_Analysis` 데이터를 연동하여 학생별 맞춤형 종합 의견을 제공합니다.
    - Radar Chart(5대 영역)와 Bar Chart(심화 지표)를 통해 성적 분포를 직관적으로 시각화했습니다.

 ---------
 */
/*
 ---------
 [2026-02-13] (v14)

 1. **데이터 연동 정밀 최적화 및 필드 매칭 강화**
    - 구글 시트의 실제 헤더 양식과 앱 내 상수의 불일치(공백 차이 등)를 해결하기 위해 `DEPT_SPECS` 필드명을 시트와 동일하게 동기화했습니다.
    - `sheetsService.js`의 `normalize` 로직을 강화하여 공백, 괄호, 특수문자(`-`, `_`, `/`) 차이가 있더라도 유연하게 헤더를 찾아내도록 개선했습니다.
    - 성적 필드 중 '개별보정(Raw)' 필드의 잔여 공백을 제거하여 데이터 저장 누락을 완벽히 차단했습니다.

 2. **운영 환경 배포 및 디버깅 시스템 구축**
    - Firebase Hosting 배포를 완료하였으며, 라이브 환경에서의 정상 작동을 확인했습니다.
    - 성적 저장 프로세스를 실시간으로 모니터링할 수 있도록 상세 콘솔 로그를 추가하여 향후 유지보수 편의성을 높였습니다.

 ---------
 */
/*
 ---------
 [2026-02-11] (v12)

 1. **시트 이름 공백/특수문자 호환성 개선**
    - 시트 이름에 공백이나 특수문자(예: '-', '/', 괄호 등)가 포함된 경우 API 호출이 실패하여 과거 성적이 0으로 표시되던 문제를 해결했습니다.
    - sheetsService.js의 모든 range 문자열에 작은따옴표를 추가하여 Google Sheets API 표준 형식을 준수하도록 수정했습니다.
    - 이제 어떤 형태의 시트 이름이라도 안정적으로 데이터를 조회하고 저장할 수 있습니다.

 ---------
 [2026-02-11] (v11)

 1. **시트 이름 변경 시 데이터 동기화 최적화**
    - 시트 이름을 바꾼 직후 과거 성적(Trend Analysis)이 사라지던 현상을 해결했습니다.
    - 활성 탭 이름을 수정한 후 즉시 새로운 이름으로 데이터를 재로드하도록 로직을 보강했습니다.

 2. **참조 시트 설정('지난 시험지') 로딩 보완**
    - 시트 내 'lastmark' 또는 '지난 시험지' 열을 찾을 때 한글 헤더 매칭 가능성을 높여 과거 성적 로딩의 안정성을 강화했습니다.

 ---------
 [2026-02-10] (v10)

 1. **시험지(탭) 이름 변경 기능 추가**
    - 사이드바의 시험지 목록에 **수정 버튼(연필 아이콘)**을 추가했습니다.
    - 이제 시험지의 이름을 웹 앱에서 즉시 변경할 수 있으며, 실제 구글 시트의 탭 이름도 동기화됩니다.

 2. **시험지 관리 UI 고도화**
    - 수정 및 삭제 아이콘을 나란히 배치하여 관리 접근성을 높였습니다.
    - 활성화된 탭의 이름을 변경하거나 삭제할 경우의 앱 상태 동기화 로직을 강화했습니다.

 ---------
 [2026-02-10] (v9)

 1. **학생 삭제 로직 안정화**
    - 학생 삭제 시 행(Row) 전체를 삭제하던 방식에서 **데이터 범위만 비우기(A:L Clear)** 방식으로 변경했습니다.
    - 이를 통해 M열 이후에 작성된 수식이나 설정값들이 지워지지 않도록 보호합니다.

 2. **시험지(탭) 관리 기능 추가**
    - 사이드바의 시험지 목록에 **삭제 버튼(쓰레기통 아이콘)**을 추가했습니다.
    - 불필요한 시험지 탭을 웹 앱 상에서 즉시 삭제하고 정리할 수 있습니다.

 ---------
 [2026-02-10] (v8)

 1. **점수 데이터 동기화 및 실시간 합계 시스템 구축**
    - **통합 계산 로직(`getCalculatedSum`) 도입**: 상단 요약 위젯, 학생 목록 총점, 성적 추세 그래프의 현재 점수를 모두 하나로 통일하여 데이터 불일치 문제를 원천 해결했습니다.
    - **실시간 피드백**: 점수를 입력하거나 수정하는 즉시 모든 UI 요소에 합계가 실시간으로 반영됩니다.

 2. **'개별보정' 필드 고도화 및 데이터 보존력 강화**
    - **지능형 필드 매핑**: 시트의 컬럼명과 앱 내 명칭 사이의 미세한 차이(공백, 대소문자 등)를 자동으로 감지하여 데이터 누락이나 수정 불능 현상을 해결했습니다.
    - **점수 보존 및 편집**: 이제 '개별보정' 점수를 처음 입력하거나 나중에 수정할 때 기존 값이 초기화되지 않고 안전하게 보존됩니다.
    - **입력 제한 상향**: 개별보정 항목의 최대 입력 가능 점수를 100점으로 확대했습니다.

 3. **사용자 경험(UX) 및 가시성 개선**
    - **작업 연속성 확보**: '변경 사항 적용하기'를 눌러 폼이 초기화된 후에도, 방금 저장한 학생의 합계가 상단 위젯에 그대로 유지되어 전후 비교를 돕습니다.
    - **리스트 상세 보기**: 학생 목록의 '입력 상황' 칸에 개별보정 점수를 포함한 모든 세부 항목을 명시적으로 표시하여 한눈에 파악할 수 있게 했습니다.
    - **학부 자동 인식**: 수정 모드 진입 시 학생의 학년과 점수 정보를 분석하여 초등/중등/고등 학부를 자동으로 선택해줍니다.

 ---------
 */
/*
 ---------
 [2026-02-09] (v5)

 1. **LastMark 저장 버그 수정**: 시트 이름에 공백이 있을 때 2행(1학기 전) 데이터가 기록되지 않던 문제를 해결했습니다.
 2. **레이아웃 최적화**: 
    - 대시보드 요약 지표 카드를 최상단으로 옮겼습니다.
    - 상단 카드 순서를 [성적표 생성 | 시험지 목록] 순서로 다시 조정했습니다.
    - 하단에 불필요하게 남아있던 중복 성적표 생성 섹션을 제거했습니다.
 3. **입력 상황 UI 가시성 강화**:
    - 현재 선택된 시험지가 무엇인지 파란색 강조 섹션과 "~에 입력중입니다" 문구를 통해 명확히 표시합니다.
 4. **완료 상태 체크 로직 정밀화**:
    - 학부별로 정의된 실제 점수 입력 필드(Raw)가 모두 채워졌는지 여부를 기준으로 '완료/미완' 상태를 판단하도록 개선했습니다.

 ---------
 */
/*
 ---------
 [2026-02-09] (v4)
   - 점수 저장 버그 해결: 헤더 명칭 유연 매칭 로직 도입 ("L/C" 입력 시 "L/C (Raw)" 열 자동 탐색)
   - 참조 정보 자동 복구: 시트 전환 시 `LastMark` 열에 저장된 과거 참조 시트 설정을 자동으로 불러오도록 개선

 2. 대시보드 구조 전면 혁신 (2단 그리드 레이아웃)
   - 사이드바 제거: 복잡한 사이드바를 없애고 메인 화면을 넓게 활용하여 가시성 확보
   - 최상단 전진 배치: '새 시험 성적표 생성'과 '시험지 목록'을 최상단 2단 레이아웃으로 재배치하여 동선 최적화

 3. 명칭 및 리스트 정밀화
   - 섹션 명칭 변경: '과목별 점수 기록' → '과목별 개수/점수 기록', '과목별 성적' → '입력 상황'
   - 데이터 표시 제한: 학생 목록의 '입력 상황'에서 현재 선택된 시트의 과목 점수만 필터링하여 출력 및 합산

 ---------
 */
/*
 ---------
 [2026-02-09]

 1. 학부(Department)별 맞춤형 환경 구축
   - 초등부, 중등부, 고등부 선택 기능 및 학부별 전용 과목 필드(L/C, R/C, 청해 등) 자동 전환 구현
   - 학부별 설정된 최대 점수(10, 25, 5 등) 초과 입력 방지 및 경고 로직 적용

 2. UI 레이아웃 직관성 고도화
   - '현재 시험지 이동' 드롭다운을 데이터 입력창(ENTRY) 상단 헤더로 통합하여 작업 동선 최적화
   - '지난 시험지' 입력 필드 제거(상단 추세 바로 대체) 및 학년 옵션(초4, 초5) 추가

 3. 데이터 영속성 및 관리 정밀화
   - 시트 생성 시 선택된 참조 정보를 `LastMark` 열 2~4행에 자동/영구 기록하는 로직 구현
   - 현재 시트의 유효한 헤더 정보만 필터링하여 합산(Total) 및 표시함으로써 데이터 혼선 차단

 ---------
 */
/*
 ---------
 [2026-02-09]

 1. 데이터 입력 무결성 강화 (대시보드 로그인 후 입력 이슈 해결)
   - 시트 헤더 매핑 로직을 대폭 개선하여 공백이나 대소문자 차이로 인한 데이터 누락 방지 ('시험종류' <-> '시험 종류' 등)
   - '지난 시험지', '참조', 'LastMark' 등 다양한 컬럼 명칭에 대한 자동 감지 및 연동 지원

 2. UI/UX 보완
   - 성적 입력 폼에 '지난 시험지 (참조)' 필드 추가하여 연동 상태 시각화
   - 학생 목록 및 종합 성적 리포트에 참조 시험지 정보 표시 레이아웃 추가
   - 학년(Grade) 필드 선택 옵션 최적화 및 라벨링 수정

 ---------
 */
/*
---------
[2026 02 08]

[참조 시트 설정 자동 기록 및 UI 명칭 변경]
- 참조 시트 선택 필드명 변경: '1/2/3학기 전 성적표'로 명칭을 직관적으로 개선.
- 설정 영속성 확보: 참조 시트를 선택하면 현재 시트의 'lastmark' 열 2~4행에 해당 시트 이름이 즉시 기록됩니다.
- 지능형 자동 로드: 다른 시험지(탭)로 이동할 때, 시트에 기록된 정보를 바탕으로 과거 성적 참조 설정을 자동으로 불러옵니다.
---------
*/
/*
---------
[2026 02 08]

[성적 입력 폼 간소화 및 집중] 
- 'SCORE ENTRY' 섹션 최적화: 시트 헤더 중 'raw' 키워드가 포함된 필드만 입력창으로 노출하도록 필터링.
- 입력 피로도 감소: 과거 성적 필드들을 UI에서 제거하여 번거로운 입력 과정을 없애고, 이번 회차 점수(raw) 입력에만 집중하도록 디자인 개선.
- 인적기본사항 유지: 학생 이름, 학교, 학년 등의 필수 정보는 그대로 유지.
---------
*/
/*
---------
[2026 02 08]

[성적 추세 분석 기능 추가] 
- 다중 참조 시트(최대 3개) 선택 기능 추가.
- 'lastmark' 자동 추적: 학생 이름을 입력하면 참조 시트에서 해당 학생의 최신 점수를 자동으로 로드.
- 자동 폼 입력: 로드된 과거 성적을 현재 시트의 첫 3개 과목 필드에 자동으로 채워주는 편의 기능 적용.
- 트렌드 UI: 입력폼 상단에 선택된 3개 시트의 성적 변화를 시각적으로 표시.
---------
*/
/*
---------
[2026 02 08]

[초/중/고 통합 시스템 확장] 
- 다중 템플릿 지원: 'Template_'로 시작하는 시트들을 템플릿으로 자동 인식 및 선택 기능 추가.
- 동적 필드 렌더링: 시트 헤더를 분석하여 점수 항목(LC, RC 등)을 자동 생성하는 로직 구현.
- 데이터 무결성: 탭 이름을 수정해도 데이터 연동이 깨지지 않도록 헤더 맵핑 기반 저장 방식 적용.
- 리포트 모달 개선: 가변적인 성적 항목을 유연하게 출력하도록 UI 고도화.
---------
*/
/*
 ---------
 [2026-02-08]

 1. 과목별 점수 라벨 명칭 및 스타일 최종 수정
    - VOCA -> Voca, GRAMMAR -> Gr, SYNTAX -> Syn으로 단축하여 레이아웃 최적화.
    - 'uppercase' 스타일을 제거하여 사용자가 요청한 대소문자 표기를 정확히 반영.
    - 가시성을 위해 라벨 폰트 크기를 10px로 미세 조정.
 ---------
 */
/*
 ---------
 [2026-02-08]

 1. 과목별 점수 UI 배열 수정
    - 그리드 시스템 및 라벨 높이 최적화를 통해 입력 칸이 어긋나던 버그 해결.

 2. 헤더 기반 동적 열 매핑 도입
    - 시트의 열 순서와 관계없이 헤더 이름(이름, 학교, LC 등)을 찾아 데이터를 입력하도록 로직 고도화.
    - 시트 구조 변경 시에도 코드 수정 없이 정상 작동 보장.
 ---------
 */
/*
 ---------
 [2026-02-08]

 1. 대시보드 UI 전면 개편
    - 실버/블루 톤의 정갈하고 차분한 테마 적용.
    - 버튼 가시성 확보 및 전체 레이아웃 정돈.

 2. 날짜 입력 로직 수정
    - 응시일 선택 시 당일(오늘)을 포함하도록 max 값 조정.

 3. 폼 초기화 기능 추가
    - 성적 저장 성공 시 이름 및 점수 필드 자동 초기화 및 이름 필드 포커싱.
 ---------
 */
/*
 ---------
 [2026-02-08]

 1. 성적 저장 위치 로직 개선
    - 기존 'appendRow' 방식은 시트 내 다른 셀(D2, E2 등)에 데이터가 있을 경우 3행부터 입력되는 문제가 있었음.
    - A열(이름)을 기준으로 실제 데이터가 있는 행을 계산하여, 비어있을 경우 2행부터 순차적으로 입력되도록 수정 완료.

 2. 사용자 피드백 강화
    - 성적 저장 성공 시 몇 번째 행에 기록되었는지 명시하여 오동작 여부를 쉽게 확인할 수 있도록 함.
 ---------
 */


